jQuery(function(s){var t,d,f={message:null,overlayCSS:{background:"#000",opacity:.6},ignoreIfBlocked:!0},u=function(e){e=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|shorts\/)([^#\&\?]*).*/),e=e&&11===e[2].length?e[2]:null;return e},y=function(e){var a,e=e.match(/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/);return a=e?e[5]:a},r=function(){return"id-"+Math.random().toString(36).substr(2,16)},w=function(e,a,i,o,d){var t=s(".product_video .ywcfav_woocommerce_video"),n="ywcfav_video_"+r(),t=t.size(),e={video_type:e,video_name:o,video_content:d,video_img:i,video_id:n,video_host:a,product_id:woocommerce_admin_meta_boxes.post_id,loop:t,action:ywcfav.actions.add_new_video_row};s.ajax({type:"POST",url:ywcfav.admin_url,data:e,dataType:"json",success:function(e){s(".product_video").append(e.result),s("body").trigger("ywcfav_new_content_insert",[n,o]),s("body").trigger("ywcfav_featured_insert")}})},l=(s(document).on("ywcfav_row_insert",function(e){s("#ywcfav_video_add_by").val("").change(),s("#ywcfav_video_add_by_id").val(""),s("#ywcfav_video_add_by_url").val(""),s("#ywcfav_video_add_by_embedded").val(""),s("#ywcfav_video_name").val(""),s("#ywcfav_video_url_up").val(""),s("#ywcfav_video_id_up").val("")}),s(document).on("ywcfav_featured_insert",function(e){s("input").removeClass("error_field"),s("select").removeClass("error_field"),s("textarea").removeClass("erorr_field")}),s(document).on("ywcfav_new_content_insert",function(e,a,i){var o=s(".ywcfav_select_featured_content"),d=s(".select_featured");o.block(f),d.append('<option value="'+a+'">'+i+"</option>"),setTimeout(function(){o.unblock()},500)}),s(document).on("ywcfav_remove_content",function(e,a){var i=s(".ywcfav_select_featured_content"),o=s(".select_featured");i.block(f),o.find('option[value="'+a+'"]').remove(),setTimeout(function(){i.unblock()},500)}),s("#ywcfav_video_add_by_upload").on("click",function(e){var a=s(this),o=s(".ywfav_add_video");e.preventDefault(),t||(e=[new wp.media.controller.Library({library:wp.media.query({type:"video"}),multiple:!1,title:a.data("choose"),priority:20,filterable:"uploaded"})],(t=wp.media.frames.downloadable_file=wp.media({title:a.data("choose"),library:{type:"video"},button:{text:a.data("choose")},multiple:!1,states:e})).on("select",function(){var a="",i="",e=(t.state().get("selection").map(function(e){"video"!=(e=e.toJSON()).type?alert(ywcfav.error_video):e.url&&(a=e.url,i=e.id)}),s(document).find("#ywcfav_video_url_up"));s(document).find("#ywcfav_video_id_up").val(i),e.val(a),o.click()})),t.open()}),s(document).on("click",".ywcfav_upload_image_button",function(e){var o=s(this),e=(e.preventDefault(),[new wp.media.controller.Library({library:wp.media.query({type:"image"}),multiple:!1,title:o.data("choose"),priority:20,filterable:"all"})]);(d=wp.media.frames.downloadable_file=wp.media({title:o.data("choose"),library:{type:"image"},button:{text:o.data("choose")},multiple:!1,states:e})).on("select",function(){var a,i;d.state().get("selection").map(function(e){(e=e.toJSON()).url&&(a=e.url,i=e.id,o.parent().find(".thumbn_id").val(i),o.find(".ywcfav_thumbn").attr("src",a))})}),d.open()}),function(a,e,i,o,d,t){var n=a.find(".ywcfav_variable_video_container"),c=n.data("loop"),_=a.find('input:hidden[name^="variable_post_id"]').val(),e={video_id:"ywcfav_video_"+r(),video_type:e,video_name:d,video_content:t,video_host:i,video_img:o,product_id:_,loop:c,action:ywcfav.actions.add_new_video_variation};s.ajax({type:"POST",url:ywcfav.admin_url,data:e,dataType:"json",success:function(e){n.html(e.result),a.find(".ywcfav_variable_video_add_container").hide(),s("body").trigger("ywcfav_featured_insert")}})});s(document).on("woocommerce_variations_loaded woocommerce_variations_added",function(){s(document).on("change",".ywcfav_variation_video_add_by",function(e){var a=s(this),i=a.val(),o=s(this).closest(".woocommerce_variation").find(".ywcfav_variable_video"),d=o.find(".variation_video_add_by_id"),t=o.find(".variation_video_add_by_url"),n=o.find(".variation_video_add_by_embedded"),c=o.find(".variation_video_add_by_upload"),_=o.find(".variation_video_type"),r=o.find(".variation_video_title"),v=o.find(".variation_video_button_add");switch(a.hasClass("error_field")&&a.removeClass("error_field"),i){case"id":r.show(),d.show(),t.hide(),n.hide(),c.hide(),_.show(),v.show();break;case"url":r.show(),d.hide(),t.show(),n.hide(),c.hide(),_.show(),v.show();break;case"embd":r.show(),d.hide(),t.hide(),n.show(),c.hide(),_.hide(),v.show();break;case"upload":r.show(),d.hide(),t.hide(),n.hide(),c.show(),_.hide(),v.hide();break;default:r.hide(),d.hide(),t.hide(),n.hide(),c.hide(),_.hide(),v.hide()}}),s(document).on("click",".ywcfav_add_variable_video",function(e){var a=s(this).parents(".woocommerce_variation"),i=a.find(".ywcfav_variation_video_add_by").val(),o="",d="",t=a.find(".ywcfav_variation_video_title"),n=t.val(),c=!1;switch(""==n&&(c=!0,t.addClass("error_field")),i){case"id":o=a.find(".ywcfav_variation_video_add_by_id"),""==(d=o.val())&&(c=!0);break;case"url":o=a.find(".ywcfav_variation_video_add_by_url"),""==(d=o.val())&&(c=!0);break;case"embd":o=a.find(".ywcfav_variation_video_add_by_embedded"),""==(d=o.val())&&(c=!0);break;case"upload":o=a.find(".ywcfav_variation_video_id"),""==(d=o.val())&&(c=!0)}if(c)o.parent().addClass("error_field"),e.preventDefault();else{var _=ywcfav.video_placeholder_img_id;if(a.block(f),"upload"==i)l(a,i,"host",_,n,d),setTimeout(function(){a.unblock()},500);else if("embd"==i)l(a,i,"embedded",_,n,encodeURI(d)),setTimeout(function(){a.unblock()},500);else{var r=a.find(".ywcfav_variation_video_type_host").val(),v="";switch(i){case"id":v=d;break;case"url":v=("vimeo"==r?y:u)(d)}t={ywcfav_id:v,ywcfav_host:r,ywcfav_name:n,action:ywcfav.actions.save_thumbnail_video};s.ajax({type:"POST",url:ywcfav.admin_url,data:t,dataType:"json",success:function(e){_="ok"==e.result?e.id_img:ywcfav.video_placeholder_img_id,l(a,i,r,_,n,encodeURI(d)),a.unblock(),a.addClass("variation-needs-update")}})}}}),s(document).on("click",".remove_video",function(e){var a=s(this).closest(".woocommerce_variation"),i=a.find(".ywcfav_variable_video_container"),o=a.find(".ywcfav_variable_video_add_container");a.block(f),setTimeout(function(){i.html(""),a.unblock(),a.addClass("variation-needs-update"),o.find("input").val(""),o.find("select").val(""),o.show()},500)}),s(document).on("click",".ywcfav_variation_upload_image_button",function(e){var o=s(this),e=(e.preventDefault(),[new wp.media.controller.Library({library:wp.media.query({type:"image"}),multiple:!1,title:o.data("choose"),priority:20,filterable:"all"})]);(d=wp.media.frames.downloadable_file=wp.media({title:o.data("choose"),library:{type:"image"},button:{text:o.data("choose")},multiple:!1,states:e})).on("select",function(){var a,i;d.state().get("selection").map(function(e){(e=e.toJSON()).url&&(a=e.url,i=e.id,o.closest(".woocommerce_variation").find(".thumbn_id").val(i),o.closest(".woocommerce_variation").find(".ywcfav_variation_thumbn").attr("src",a),o.closest(".woocommerce_variation").addClass("variation-needs-update"))})}),d.open()}),s(document).on("click",".ywcfav_variation_video_add_by_upload",function(e){var a=s(this),i=a.parent().parent(),o=i.find(".ywcfav_variation_video_id"),d=i.find(".ywcfav_add_variable_video"),i=(e.preventDefault(),[new wp.media.controller.Library({library:wp.media.query({type:"video"}),multiple:!1,title:a.data("choose"),priority:20,filterable:"uploaded"})]);(t=wp.media.frames.downloadable_file=wp.media({title:a.data("choose"),library:{type:"video"},button:{text:a.data("choose")},multiple:!1,states:i})).on("select",function(){var a="";t.state().get("selection").map(function(e){"video"!=(e=e.toJSON()).type?alert(ywcfav.error_video):e.id&&(a=e.id)}),o.val(a),d.click()}),t.open()})}),s("body").on("ywcfav_admin_field_init",function(){var l=s("#ywcfav_video_add_by"),e=s(".ywfav_add_video");s(".ywcfav_delete"),l.on("change",function(e){var a=s(this),i=a.val(),o=a.parents("#ywcfav_form_container"),d=o.find(".video_add_by_id"),t=o.find(".video_add_by_url"),n=o.find(".video_add_by_embedded"),c=o.find(".video_add_by_upload"),_=o.find(".video_type_host"),r=o.find(".video_name"),v=o.find(".ywfav_add_video");switch(a.hasClass("error_field")&&a.removeClass("error_field"),r.show(),i){case"id":d.show(),t.hide(),n.hide(),c.hide(),_.show(),v.show();break;case"url":d.hide(),t.show(),n.hide(),c.hide(),_.show(),v.show();break;case"embd":d.hide(),t.hide(),n.show(),c.hide(),_.hide(),v.show();break;case"upload":d.hide(),t.hide(),n.hide(),c.show(),_.hide(),v.hide();break;default:d.hide(),t.hide(),n.hide(),c.hide(),_.hide(),r.hide(),v.hide()}}),e.on("click",function(e){var a=l.val(),i="",o="",d=!1,t=s("#ywcfav_video_name"),n=t.val();if(""==a)l.addClass("error_field"),e.preventDefault();else if(""==n)t.addClass("error_field"),e.preventDefault();else{switch(a){case"id":i=s("#ywcfav_video_add_by_id"),""==(o=i.val())&&(d=!0);break;case"url":i=s("#ywcfav_video_add_by_url"),""==(o=i.val())&&(d=!0);break;case"embd":i=s("#ywcfav_video_add_by_embedded"),""==(o=i.val())&&(d=!0);break;case"upload":i=s("#ywcfav_video_id_up"),""==(o=i.val())&&(d=!0)}if(d)i.parent().addClass("error_field"),e.preventDefault();else{var c=ywcfav.video_placeholder_img_id,_=s("#ywcfav_video_data");if(_.block(f),"upload"==a)w(a,"host",c,n,o),setTimeout(function(){_.unblock()},500);else if("embd"==a)w(a,"embedded",c,n,encodeURI(o)),setTimeout(function(){_.unblock()},500);else{var r=s("#ywcfav_video_type_host").val(),v="";switch(a){case"id":v=o;break;case"url":v=("vimeo"==r?y:u)(o)}t={ywcfav_id:v,ywcfav_host:r,ywcfav_name:n,action:ywcfav.actions.save_thumbnail_video};s.ajax({type:"POST",url:ywcfav.admin_url,data:t,dataType:"json",success:function(e){c="ok"==e.result?e.id_img:ywcfav.video_placeholder_img_id,w(a,r,c,n,encodeURI(o)),_.unblock()}})}s("body").trigger("ywcfav_row_insert")}}}),s(document).on("click",".ywcfav_delete",function(e){e.preventDefault();var e=s(this).parent().parent(),a=e.find(".ywcfav_video_id").val();e.remove(),s("body").trigger("ywcfav_remove_content",[a])}),s(".ywcfav_insert_track").on("click",function(){var a,i=s("#ywcfav_audio_data"),o=s("#ywcfav_audio_name"),d=s("#ywcfav_audio_url"),t=o.val(),e=d.val(),n=!1;""==t&&(o.addClass("error_field"),n=!0),""==e&&(d.addClass("error_field"),n=!0),n||(i.block(f),n=s(".product_audio .ywcfav_woocommerce_audio_data"),a="ywcfav_audio_"+r(),n=n.size(),e={audio_name:t,audio_content:encodeURI(e),audio_img:ywcfav.audio_placeholder_img_id,audio_id:a,product_id:woocommerce_admin_meta_boxes.post_id,loop:n,action:ywcfav.actions.add_new_audio_row},s.ajax({type:"POST",url:ywcfav.admin_url,data:e,dataType:"json",success:function(e){s(".product_audio").append(e.result),i.unblock(),o.val(""),d.val(""),s("body").trigger("ywcfav_new_content_insert",[a,t]),s("body").trigger("ywcfav_featured_insert")}}))}),s(document).on("click",".ywcfav_delete_audio",function(e){e.preventDefault();var e=s(this).parent().parent(),a=e.find(".ywcfav_audio_id").val();e.remove(),s("body").trigger("ywcfav_remove_content",[a])})}).trigger("ywcfav_admin_field_init"),s("#ywcfav_copy_section").length&&s("#ywcfav_copy_content").on("click",function(e){e.preventDefault();var a=s(this),e=a.data("product_id"),i=a.data("original_product_id");s.ajax({type:"POST",url:ywcfav.admin_url,data:{product_id:e,original_id:i,action:"ywcfav_copy_content_from_original"},dataType:"json",beforeSend:function(){a.siblings(".ajax-loading").css("visibility","visible")},complete:function(){a.siblings(".ajax-loading").css("visibility","hidden")},success:function(e){location.reload()}})}),s(".ywcfav_import_button").on("click",function(e){e.preventDefault();var a=s(this);s.ajax({type:"POST",url:ywcfav.admin_url,data:{action:ywcfav.actions.import_video_from_free},dataType:"json",beforeSend:function(){a.addClass("yith-disabled")},complete:function(){a.removeClass("yith-disabled")},success:function(e){yith.ui.modal({title:!1,content:e,footer:!1,width:150})}})})});